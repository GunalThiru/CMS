<div class="staff-container">
  <h2>Assigned Complaints</h2>

  <div *ngIf="loading" class="loading">Loading complaints...</div>

  <table *ngIf="!loading && complaints.length > 0" class="complaints-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>User ID</th>
        <th>Title</th>
        <th>Description</th>
        <th>Status</th>
        <th>Remarks</th>
        <th>Action</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let c of complaints; trackBy: trackByComplaintId">

        <td>{{ c.id }}</td>
        <td>{{ c.user_id }}</td>
        <td>{{ c.title }}</td>
        <td class="wrap-text">{{ c.description }}</td>

        <!-- STATUS SELECT (Disabled ONLY if original status was resolved) -->
        <td>
          <select [(ngModel)]="c.status" [disabled]="c.originalStatus === 'resolved'">
            <option value="in_progress">In Progress</option>
            <option value="resolved">Resolved</option>
          </select>
        </td>

        <!-- REMARKS (Never editable for staff) -->
        <td class="wrap-text">
          {{ c.remarks || 'â€”' }}
        </td>

        <!-- UPDATE BUTTON (Disabled ONLY if already resolved in DB) -->
        <td>
          <button class="update-btn"
                  (click)="attemptUpdate(c)"
                  [disabled]="c.originalStatus === 'resolved'">
            Update
          </button>
        </td>

      </tr>
    </tbody>
  </table>

  <div *ngIf="!loading && complaints.length === 0" class="no-data">
    No complaints assigned yet.
  </div>
</div>

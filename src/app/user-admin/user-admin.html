<div class="admin-container">
  <h2>Admin - Manage Complaints</h2>

  <!-- Scrollable container (IMPORTANT for fixed layout + wrapping) -->
  <div class="table-container">
    <table class="complaints-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>User ID</th>
          <th>Title</th>
          <th>Description</th>
          <th>Status</th>
          <th>Assign To (Staff ID)</th>
          <th>Remarks</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let c of complaints">

          <td>{{ c.id }}</td>
          <td>{{ c.user_id }}</td>
          <td>{{ c.title }}</td>

          <!-- Description with controlled width -->
          <td class="wrap-text">{{ c.description }}</td>

          <td>{{ c.status }}</td>

          <!-- Staff ID -->
          <td>
            <ng-container *ngIf="c.status === 'open'; else showAssignedStaff">
              <input type="number" [(ngModel)]="c.staff_id" placeholder="Staff ID" />
            </ng-container>

            <ng-template #showAssignedStaff>
              <span><strong>{{ c.staff_id || c.assigned_staff_id }}</strong></span>
            </ng-template>
          </td>

          <!-- Remarks -->
          <td>
            <ng-container *ngIf="c.status === 'open'; else showRemarks">
              <input type="text" [(ngModel)]="c.remarks" placeholder="Remarks" />
            </ng-container>

            <ng-template #showRemarks>
              <span>{{ c.remarks }}</span>
            </ng-template>
          </td>

          <!-- Action Button -->
          <td>
            <button 
              class="assign-btn"
              (click)="assignComplaint(c)"
              [disabled]="c.status !== 'open'">
              {{ c.status === 'open' ? 'Assign' : 'Assigned' }}
            </button>
          </td>

        </tr>
      </tbody>
    </table>
  </div>
</div>
